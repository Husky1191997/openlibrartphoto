{"version":3,"sources":["BottomSheetBackdrop.tsx"],"names":["React","memo","useCallback","useMemo","useRef","TouchableWithoutFeedback","Animated","and","call","cond","eq","Extrapolate","neq","not","set","isEqual","useValue","useBottomSheet","DEFAULT_OPACITY","DEFAULT_APPEARS_ON_INDEX","DEFAULT_DISAPPEARS_ON_INDEX","DEFAULT_ENABLE_TOUCH_THROUGH","DEFAULT_CLOSE_ON_PRESS","WINDOW_HEIGHT","styles","interpolate","interpolateV1","interpolateNode","interpolateV2","require","AnimatedTouchableWithoutFeedback","createAnimatedComponent","BottomSheetBackdropComponent","animatedIndex","animatedPosition","opacity","appearsOnIndex","disappearsOnIndex","enableTouchThrough","closeOnPress","style","close","containerRef","pointerEvents","isTouchable","undefined","animatedOpacity","inputRange","outputRange","extrapolate","CLAMP","handleOnPress","buttonStyle","top","containerStyle","container","current","setNativeProps","BottomSheetBackdrop"],"mappings":"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","sourcesContent":["import React, { memo, useCallback, useMemo, useRef } from 'react';\nimport { TouchableWithoutFeedback } from 'react-native';\nimport Animated, {\n  and,\n  call,\n  cond,\n  eq,\n  Extrapolate,\n  neq,\n  not,\n  set,\n} from 'react-native-reanimated';\nimport isEqual from 'lodash.isequal';\nimport { useValue } from 'react-native-redash';\nimport { useBottomSheet } from '../../hooks/useBottomSheet';\nimport {\n  DEFAULT_OPACITY,\n  DEFAULT_APPEARS_ON_INDEX,\n  DEFAULT_DISAPPEARS_ON_INDEX,\n  DEFAULT_ENABLE_TOUCH_THROUGH,\n  DEFAULT_CLOSE_ON_PRESS,\n} from './constants';\nimport { WINDOW_HEIGHT } from '../../constants';\nimport type { BottomSheetDefaultBackdropProps } from './types';\nimport { styles } from './styles';\n\nconst {\n  interpolate: interpolateV1,\n  interpolateNode: interpolateV2,\n} = require('react-native-reanimated');\nconst interpolate = interpolateV2 || interpolateV1;\n\nconst AnimatedTouchableWithoutFeedback = Animated.createAnimatedComponent(\n  TouchableWithoutFeedback\n);\n\nconst BottomSheetBackdropComponent = ({\n  animatedIndex,\n  animatedPosition,\n  opacity = DEFAULT_OPACITY,\n  appearsOnIndex = DEFAULT_APPEARS_ON_INDEX,\n  disappearsOnIndex = DEFAULT_DISAPPEARS_ON_INDEX,\n  enableTouchThrough = DEFAULT_ENABLE_TOUCH_THROUGH,\n  closeOnPress = DEFAULT_CLOSE_ON_PRESS,\n  style,\n}: BottomSheetDefaultBackdropProps) => {\n  //#region hooks\n  const { close } = useBottomSheet();\n  //#endregion\n\n  //#region variables\n  const containerRef = useRef<Animated.View>(null);\n  const pointerEvents = useMemo(() => (enableTouchThrough ? 'none' : 'auto'), [\n    enableTouchThrough,\n  ]);\n  //#endregion\n\n  //#region animation variables\n  const isTouchable = useValue(closeOnPress !== undefined ? 1 : 0);\n  const animatedOpacity = useMemo(\n    () =>\n      interpolate(animatedIndex, {\n        inputRange: [disappearsOnIndex, appearsOnIndex],\n        outputRange: [0, opacity],\n        extrapolate: Extrapolate.CLAMP,\n      }),\n    [animatedIndex, opacity, appearsOnIndex, disappearsOnIndex]\n  );\n  //#endregion\n\n  //#region callbacks\n  const handleOnPress = useCallback(() => {\n    close();\n  }, [close]);\n  //#endregion\n\n  //#region styles\n  const buttonStyle = useMemo(\n    () => [\n      style,\n      {\n        top: cond(eq(animatedIndex, disappearsOnIndex), WINDOW_HEIGHT, 0),\n      },\n    ],\n    [disappearsOnIndex, style, animatedIndex]\n  );\n  const containerStyle = useMemo(\n    () => [\n      style,\n      styles.container,\n      {\n        opacity: animatedOpacity,\n      },\n    ],\n    [style, animatedOpacity]\n  );\n  //#endregion\n  return closeOnPress ? (\n    <>\n      <AnimatedTouchableWithoutFeedback\n        accessible={true}\n        accessibilityRole=\"button\"\n        accessibilityLabel=\"Bottom Sheet backdrop\"\n        accessibilityHint=\"Tap to close the Bottom Sheet\"\n        onPress={handleOnPress}\n        style={buttonStyle}\n      >\n        <Animated.View ref={containerRef} style={containerStyle} />\n      </AnimatedTouchableWithoutFeedback>\n      <Animated.Code>\n        {() =>\n          cond(\n            and(eq(animatedPosition, disappearsOnIndex), isTouchable),\n            [\n              set(isTouchable, 0),\n              call([], () => {\n                // @ts-ignore\n                containerRef.current.setNativeProps({\n                  pointerEvents: 'none',\n                });\n              }),\n            ],\n            cond(\n              and(neq(animatedPosition, disappearsOnIndex), not(isTouchable)),\n              [\n                set(isTouchable, 1),\n                call([], () => {\n                  // @ts-ignore\n                  containerRef.current.setNativeProps({\n                    pointerEvents: 'auto',\n                  });\n                }),\n              ]\n            )\n          )\n        }\n      </Animated.Code>\n    </>\n  ) : (\n    <Animated.View pointerEvents={pointerEvents} style={containerStyle} />\n  );\n};\n\nconst BottomSheetBackdrop = memo(BottomSheetBackdropComponent, isEqual);\n\nexport default BottomSheetBackdrop;\n"]}