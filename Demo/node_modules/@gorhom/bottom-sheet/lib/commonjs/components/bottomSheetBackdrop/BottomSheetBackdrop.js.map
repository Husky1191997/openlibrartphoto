{"version":3,"sources":["BottomSheetBackdrop.tsx"],"names":["interpolate","interpolateV1","interpolateNode","interpolateV2","require","AnimatedTouchableWithoutFeedback","Animated","createAnimatedComponent","TouchableWithoutFeedback","BottomSheetBackdropComponent","animatedIndex","animatedPosition","opacity","DEFAULT_OPACITY","appearsOnIndex","DEFAULT_APPEARS_ON_INDEX","disappearsOnIndex","DEFAULT_DISAPPEARS_ON_INDEX","enableTouchThrough","DEFAULT_ENABLE_TOUCH_THROUGH","closeOnPress","DEFAULT_CLOSE_ON_PRESS","style","close","containerRef","pointerEvents","isTouchable","undefined","animatedOpacity","inputRange","outputRange","extrapolate","Extrapolate","CLAMP","handleOnPress","buttonStyle","top","WINDOW_HEIGHT","containerStyle","styles","container","current","setNativeProps","BottomSheetBackdrop","isEqual"],"mappings":"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","sourcesContent":["import React, { memo, useCallback, useMemo, useRef } from 'react';\nimport { TouchableWithoutFeedback } from 'react-native';\nimport Animated, {\n  and,\n  call,\n  cond,\n  eq,\n  Extrapolate,\n  neq,\n  not,\n  set,\n} from 'react-native-reanimated';\nimport isEqual from 'lodash.isequal';\nimport { useValue } from 'react-native-redash';\nimport { useBottomSheet } from '../../hooks/useBottomSheet';\nimport {\n  DEFAULT_OPACITY,\n  DEFAULT_APPEARS_ON_INDEX,\n  DEFAULT_DISAPPEARS_ON_INDEX,\n  DEFAULT_ENABLE_TOUCH_THROUGH,\n  DEFAULT_CLOSE_ON_PRESS,\n} from './constants';\nimport { WINDOW_HEIGHT } from '../../constants';\nimport type { BottomSheetDefaultBackdropProps } from './types';\nimport { styles } from './styles';\n\nconst {\n  interpolate: interpolateV1,\n  interpolateNode: interpolateV2,\n} = require('react-native-reanimated');\nconst interpolate = interpolateV2 || interpolateV1;\n\nconst AnimatedTouchableWithoutFeedback = Animated.createAnimatedComponent(\n  TouchableWithoutFeedback\n);\n\nconst BottomSheetBackdropComponent = ({\n  animatedIndex,\n  animatedPosition,\n  opacity = DEFAULT_OPACITY,\n  appearsOnIndex = DEFAULT_APPEARS_ON_INDEX,\n  disappearsOnIndex = DEFAULT_DISAPPEARS_ON_INDEX,\n  enableTouchThrough = DEFAULT_ENABLE_TOUCH_THROUGH,\n  closeOnPress = DEFAULT_CLOSE_ON_PRESS,\n  style,\n}: BottomSheetDefaultBackdropProps) => {\n  //#region hooks\n  const { close } = useBottomSheet();\n  //#endregion\n\n  //#region variables\n  const containerRef = useRef<Animated.View>(null);\n  const pointerEvents = useMemo(() => (enableTouchThrough ? 'none' : 'auto'), [\n    enableTouchThrough,\n  ]);\n  //#endregion\n\n  //#region animation variables\n  const isTouchable = useValue(closeOnPress !== undefined ? 1 : 0);\n  const animatedOpacity = useMemo(\n    () =>\n      interpolate(animatedIndex, {\n        inputRange: [disappearsOnIndex, appearsOnIndex],\n        outputRange: [0, opacity],\n        extrapolate: Extrapolate.CLAMP,\n      }),\n    [animatedIndex, opacity, appearsOnIndex, disappearsOnIndex]\n  );\n  //#endregion\n\n  //#region callbacks\n  const handleOnPress = useCallback(() => {\n    close();\n  }, [close]);\n  //#endregion\n\n  //#region styles\n  const buttonStyle = useMemo(\n    () => [\n      style,\n      {\n        top: cond(eq(animatedIndex, disappearsOnIndex), WINDOW_HEIGHT, 0),\n      },\n    ],\n    [disappearsOnIndex, style, animatedIndex]\n  );\n  const containerStyle = useMemo(\n    () => [\n      style,\n      styles.container,\n      {\n        opacity: animatedOpacity,\n      },\n    ],\n    [style, animatedOpacity]\n  );\n  //#endregion\n  return closeOnPress ? (\n    <>\n      <AnimatedTouchableWithoutFeedback\n        accessible={true}\n        accessibilityRole=\"button\"\n        accessibilityLabel=\"Bottom Sheet backdrop\"\n        accessibilityHint=\"Tap to close the Bottom Sheet\"\n        onPress={handleOnPress}\n        style={buttonStyle}\n      >\n        <Animated.View ref={containerRef} style={containerStyle} />\n      </AnimatedTouchableWithoutFeedback>\n      <Animated.Code>\n        {() =>\n          cond(\n            and(eq(animatedPosition, disappearsOnIndex), isTouchable),\n            [\n              set(isTouchable, 0),\n              call([], () => {\n                // @ts-ignore\n                containerRef.current.setNativeProps({\n                  pointerEvents: 'none',\n                });\n              }),\n            ],\n            cond(\n              and(neq(animatedPosition, disappearsOnIndex), not(isTouchable)),\n              [\n                set(isTouchable, 1),\n                call([], () => {\n                  // @ts-ignore\n                  containerRef.current.setNativeProps({\n                    pointerEvents: 'auto',\n                  });\n                }),\n              ]\n            )\n          )\n        }\n      </Animated.Code>\n    </>\n  ) : (\n    <Animated.View pointerEvents={pointerEvents} style={containerStyle} />\n  );\n};\n\nconst BottomSheetBackdrop = memo(BottomSheetBackdropComponent, isEqual);\n\nexport default BottomSheetBackdrop;\n"]}